{
  "magic": "E!vIA5L86J2I",
  "timestamp": "2025-05-18T02:05:44.667115+00:00",
  "repo": "thibmeu/http-message-signatures-directory",
  "labels": [
    {
      "name": "bug",
      "description": "Something isn't working",
      "color": "d73a4a"
    },
    {
      "name": "documentation",
      "description": "Improvements or additions to documentation",
      "color": "0075ca"
    },
    {
      "name": "duplicate",
      "description": "This issue or pull request already exists",
      "color": "cfd3d7"
    },
    {
      "name": "enhancement",
      "description": "New feature or request",
      "color": "a2eeef"
    },
    {
      "name": "good first issue",
      "description": "Good for newcomers",
      "color": "7057ff"
    },
    {
      "name": "help wanted",
      "description": "Extra attention is needed",
      "color": "008672"
    },
    {
      "name": "invalid",
      "description": "This doesn't seem right",
      "color": "e4e669"
    },
    {
      "name": "question",
      "description": "Further information is requested",
      "color": "d876e3"
    },
    {
      "name": "wontfix",
      "description": "This will not be worked on",
      "color": "ffffff"
    }
  ],
  "issues": [
    {
      "number": 4,
      "id": "I_kwDOOXJyWM6ywrL-",
      "title": "Discuss tradeoff between replay resistance and efficiency",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/issues/4",
      "state": "OPEN",
      "author": "jhoyla",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "When loading a single website it's not uncommon to have dozens, if not hundreds, of requests to the same FQDN. Creating and verifying dozens of signed requests that only differ in the nonce almost simultaneously would be very inefficient, but not requiring a nonce (and thus allowing the signature to be cached) allows for replays. Perhaps the draft should discuss options for balancing these two.\nSome options include:\n1. Allow small numbers of replays. This probably requires state on the server side, but given that we need to store nonces to enforce them this might not be too bad.\n2. Allow replays but only for signatures with very short (e.g. 5 second) lifetimes. This still lets a malicious client do less work than the server (unless the server caches the verification result I guess), but given that this is non-repudiatable, I don't think it's a significant risk. \n3. Enforcing nonces strictly, but providing a cookie along with each response to a signed request. The client can send a few signed requests in parallel, and once the first one has a response switch to using the cookie. The downside of this is that if an adversary gets a signed request they can exchange it for a cookie, which can then be replayed, but this can be managed through cookie mechanisms.\n",
      "createdAt": "2025-04-16T09:52:49Z",
      "updatedAt": "2025-05-16T11:22:58Z",
      "closedAt": null,
      "comments": [
        {
          "author": "thibmeu",
          "authorAssociation": "OWNER",
          "body": "This seems to be a lot of implementation details, and I'm not sure what would exactly be useful here or how to present it.\n\nWould you have suggestions?",
          "createdAt": "2025-05-06T17:29:57Z",
          "updatedAt": "2025-05-06T17:29:57Z"
        },
        {
          "author": "thibmeu",
          "authorAssociation": "OWNER",
          "body": "Some of these concerns seems to be shared with https://github.com/w3ctag/design-reviews/pull/1094\n\nSpecifically, how to avoid sending headers multiple time for a \"session\", concept that's out of this standard scope for now.",
          "createdAt": "2025-05-16T08:06:21Z",
          "updatedAt": "2025-05-16T08:06:21Z"
        },
        {
          "author": "jhoyla",
          "authorAssociation": "CONTRIBUTOR",
          "body": "So HTTP Message Sigs is similar to DBSC in some ways, but I think the trade-offs are very different. First, DBSC is aimed at human users, so things like adding a roundtrip have a much higher weight than they do for bots. Second, HMS cares much less about sessions. Whereas a user might want to stay logged in for days or weeks, a bot is more likely to have a short lived interaction with a zone. It also may be using the same signing key whilst acting on behalf of multiple different users, so I think the session paradigm doesn't really apply neatly. Third, we don't really care about the bots activities being linkable to each other, except in so far as they link together the activities of a single user.\n\nThe core concerns raised by MT seem to be about efficiency vs security, which also apply here, but I think the answers are very different. We rely on the security of the signature generator more, because we're talking corporate IT, rather than end-user devices. \n\nWith respect to your first comment, I am worried that most people will in practice implement option 0, allow unbounded numbers of replays, and only request new signatures on suspicion of abuse. In the unbounded replay scenario the scheme is relatively efficient for both parties, at the expense of security. Adding text describing the trade-off between efficiency and security and different patterns one might employ will hopefully steer people away from option 0.",
          "createdAt": "2025-05-16T11:22:56Z",
          "updatedAt": "2025-05-16T11:22:56Z"
        }
      ]
    },
    {
      "number": 5,
      "id": "I_kwDOOXJyWM6yw1fO",
      "title": "Threat model: Multi-CDN",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/issues/5",
      "state": "CLOSED",
      "author": "jhoyla",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "In a multi-CDN use-case all the CDNs need to trust each other, because one CDN can use signed requests that it receives to impersonate an agent to the others. This attack exists even if the CDN uses `Accept-Signature` to provide a fresh nonce, because the malicious CDN can simply forward the `Accept-Signature` message to the agent.  We should add a sentence to the threat model covering this possibility.\n\nI'm not sure how this can be avoided without cooperation from the client, because even if the CDN creates a structured / authenticated nonce, if the client doesn't understand the structure it will sign it even if it comes from the \"wrong\" CDN. Even with cooperation from the client, I'm not sure how the client could easily / reliably distinguish between CDNs.",
      "createdAt": "2025-04-16T10:09:26Z",
      "updatedAt": "2025-05-07T08:34:51Z",
      "closedAt": "2025-05-07T08:34:51Z",
      "comments": [
        {
          "author": "thibmeu",
          "authorAssociation": "OWNER",
          "body": "Possibly along this line, enhancing the security considerations to mention HTTP Message Signatures would be one identification method, and is going to be used in conjunction with others (old like IP ranges, new like req mTLS).\n\nIf the IP range of the origin was allowlisted, that would already reduce potential abuse, even if this is out of scope for this draft.",
          "createdAt": "2025-04-18T12:26:53Z",
          "updatedAt": "2025-04-18T12:26:53Z"
        }
      ]
    },
    {
      "number": 7,
      "id": "I_kwDOOXJyWM6yxH2d",
      "title": "Performance of a global nonce store",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/issues/7",
      "state": "CLOSED",
      "author": "jhoyla",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "To enforce nonces strictly the origin needs to keep a list of all nonces that it has seen whose signatures are still valid. For a multi-server architecture this could amount to a sync on a global database, which could have a significant performance cost, especially as most requests will both read and write. In practice it might make more sense to enforce weaker guarantees in the name of performance.",
      "createdAt": "2025-04-16T10:36:31Z",
      "updatedAt": "2025-05-07T08:32:58Z",
      "closedAt": "2025-05-07T08:32:58Z",
      "comments": [
        {
          "author": "thibmeu",
          "authorAssociation": "OWNER",
          "body": "Agree. I think it should suffice for the draft to remove the MUST on verify nonce uniqueness to MAY to solve the issue.\n\nA specific addition in the security consideration can be added as well",
          "createdAt": "2025-05-06T17:15:26Z",
          "updatedAt": "2025-05-06T17:15:26Z"
        }
      ]
    },
    {
      "number": 8,
      "id": "I_kwDOOXJyWM6yyKMU",
      "title": "Add acknowledgements",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/issues/8",
      "state": "CLOSED",
      "author": "thibmeu",
      "authorAssociation": "OWNER",
      "assignees": [
        "thibmeu"
      ],
      "labels": [],
      "body": "Acknowledgements need to be in at some point. Ideally before the spec is adopted by a WG.\n\nI have a list with at least 10 people I'd like to add. Let's reach out and make sure they are OK with being mentioned in a public document, and if they have specificities.",
      "createdAt": "2025-04-16T12:27:50Z",
      "updatedAt": "2025-04-30T08:28:22Z",
      "closedAt": "2025-04-30T08:28:22Z",
      "comments": [
        {
          "author": "epanero-openai",
          "authorAssociation": "NONE",
          "body": "@thibmeu happy to be acknowledged. you can use `Eugenio Panero (epanero@openai.com)` as my name. Thanks!",
          "createdAt": "2025-04-29T18:59:50Z",
          "updatedAt": "2025-04-29T19:00:13Z"
        }
      ]
    },
    {
      "number": 10,
      "id": "I_kwDOOXJyWM6zq4sH",
      "title": "Support for CBOR and COSE Keys",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/issues/10",
      "state": "OPEN",
      "author": "thibmeu",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [
        "question"
      ],
      "body": "There are multiple places where CBOR and CBOR Web keys could be introduced.\n\n1. HTTP Message Signature directory format. I'd be in favor of add `+json` at the end of the directory Media type, so that we can declare `+cbor` when relevant\n2. JSON Web Thumbprint is used as a key id. This is great because it provides a unique key id that is derived from the key material. I'd be in favor of sticking to ONE key id derivation method, even though [RFC 9679](https://www.rfc-editor.org/rfc/rfc9679.html) defines a Thumbprint for COSE Keys.",
      "createdAt": "2025-04-23T15:12:02Z",
      "updatedAt": "2025-04-23T15:12:02Z",
      "closedAt": null,
      "comments": []
    },
    {
      "number": 11,
      "id": "I_kwDOOXJyWM6z9hV0",
      "title": "Consider negative test vectors",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/issues/11",
      "state": "OPEN",
      "author": "thibmeu",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [
        "enhancement"
      ],
      "body": "This relates to https://github.com/cloudflareresearch/web-bot-auth/issues/4\n\nIt should be fine to limit these vectors to Ed25519 initially.",
      "createdAt": "2025-04-25T07:36:43Z",
      "updatedAt": "2025-05-06T17:12:22Z",
      "closedAt": null,
      "comments": []
    },
    {
      "number": 12,
      "id": "I_kwDOOXJyWM60Pl9N",
      "title": "Consideration around signing Signature-Agent header",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/issues/12",
      "state": "CLOSED",
      "author": "thibmeu",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [
        "question"
      ],
      "body": "Vercel [shared](https://mailarchive.ietf.org/arch/msg/web-bot-auth/-ON1BdJMNWZmTgZGshBOHxnTSiQ/) they have been working on a similar proposal on their side.\n\nOne difference is they include the bot origin as part of the signature. In the current draft, this would be signing `Signature-Agent` header.\n\nWith [RFC 9421 Section 2.1](https://datatracker.ietf.org/doc/html/rfc9421#name-http-fields), this can be done by adding `\"signature-agent\"` to the component part of `Signature-Input`.",
      "createdAt": "2025-04-28T07:31:30Z",
      "updatedAt": "2025-04-30T15:22:23Z",
      "closedAt": "2025-04-30T15:22:23Z",
      "comments": [
        {
          "author": "punkeel",
          "authorAssociation": "NONE",
          "body": "I strongly want (-> MUST) `Signature-Agent` to be included in the `Signature-Input` to be considered valid by origins.\n\nAlso, +1 on having this be a signature **component** rather than a brand new header.",
          "createdAt": "2025-04-29T13:53:55Z",
          "updatedAt": "2025-04-29T13:53:55Z"
        },
        {
          "author": "thibmeu",
          "authorAssociation": "OWNER",
          "body": "I'll see how to word the fact that \"if there is a Signature-Agent\" header, it MUST be signed. If there is no such header, it's not signed.\n\nAlso forgot to mention this comes from @cramforce, in case they want to weight in.",
          "createdAt": "2025-04-29T14:02:29Z",
          "updatedAt": "2025-04-29T14:02:29Z"
        }
      ]
    },
    {
      "number": 13,
      "id": "I_kwDOOXJyWM60P0gW",
      "title": "Relation to OAuth 2",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/issues/13",
      "state": "OPEN",
      "author": "thibmeu",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [
        "enhancement"
      ],
      "body": "There has been a couple of feedback about why not use OAuth 2, DPoP, maybe OIDC in general. We should consider having a section in the appendix to address that.\n\nFrom the top of my head:\n* This is similar indeed: one standard which we scope specifically for bots, with a tag/purpose, key ID definition\n* HTTP Message Signatures provides @authority derived component\n* The use of JWK Thumbprint as keyid is sufficient. No need for DPoP\n* DPoP is specifically addressing replay and access refresh\n* The Authorization server is the client, which seems to be closer to HTTP Message Signatures design\n* Extensibility to allow request integrity and non-repudiability with HTTP Message Signatures, possibly with mulitple ones\n",
      "createdAt": "2025-04-28T07:55:30Z",
      "updatedAt": "2025-05-07T06:42:15Z",
      "closedAt": null,
      "comments": []
    },
    {
      "number": 14,
      "id": "I_kwDOOXJyWM60P13-",
      "title": "Consider `Signature-Agent` header to be more than HTTP Message Signatures directory",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/issues/14",
      "state": "OPEN",
      "author": "thibmeu",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [
        "question"
      ],
      "body": "At the moment, this is defined as providing an HTTP Message Signatures Directory.\n\nIf OAuth 2 is used as well (should it #13 ?), it could be interesting to have something broader.",
      "createdAt": "2025-04-28T07:57:17Z",
      "updatedAt": "2025-04-30T08:03:43Z",
      "closedAt": null,
      "comments": [
        {
          "author": "thibmeu",
          "authorAssociation": "OWNER",
          "body": "Discussed with @EthanHeilman as it relates to https://github.com/dickhardt/openid-key-binding/ as well.\nOne main difference is that our current draft mandates the kid to be the JWK thumbprint for global uniqueness constraint. This is a similar approach.",
          "createdAt": "2025-04-30T08:03:42Z",
          "updatedAt": "2025-04-30T08:03:42Z"
        }
      ]
    },
    {
      "number": 19,
      "id": "I_kwDOOXJyWM62OuIF",
      "title": "Consider integration of `Signature-Agent` with robots.txt",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/issues/19",
      "state": "OPEN",
      "author": "thibmeu",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [],
      "body": "In addition to using User-Agent directive as per [RFC 9309](https://datatracker.ietf.org/doc/html/rfc9309), it would be interesting for robots.txt to support Signature-Agent header.",
      "createdAt": "2025-05-12T15:11:01Z",
      "updatedAt": "2025-05-12T15:11:01Z",
      "closedAt": null,
      "comments": []
    },
    {
      "number": 20,
      "id": "I_kwDOOXJyWM626Ux_",
      "title": "Add wording that `Signature` header  MUST be sent over a secure connection",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/issues/20",
      "state": "OPEN",
      "author": "jhoyla",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "Because the `Signature` header is effectively a bearer token, and can be proxied, and in some cases replayed, there needs to be a `MUST` requiring that the `Signature` header is always sent (and proxied) over secure (esp. confidential) channels.",
      "createdAt": "2025-05-16T11:28:46Z",
      "updatedAt": "2025-05-16T11:44:17Z",
      "closedAt": null,
      "comments": [
        {
          "author": "thibmeu",
          "authorAssociation": "OWNER",
          "body": "A possible text from [RFC 6750 Section 5.3](https://www.rfc-editor.org/rfc/rfc6750#section-5.3)\n\n> Always use TLS (https):  Clients MUST always use TLS [[RFC5246](https://www.rfc-editor.org/rfc/rfc5246)]\n> (https) or equivalent transport security when making requests with\n> bearer tokens.  Failing to do so exposes the token to numerous\n> attacks that could give attackers unintended access.",
          "createdAt": "2025-05-16T11:32:24Z",
          "updatedAt": "2025-05-16T11:32:24Z"
        },
        {
          "author": "thibmeu",
          "authorAssociation": "OWNER",
          "body": "If mandating TLS, we should also refer to [RFC 9421 Section 7.1.2](https://datatracker.ietf.org/doc/html/rfc9421#name-use-of-tls) regarding the use of TLS.",
          "createdAt": "2025-05-16T11:34:20Z",
          "updatedAt": "2025-05-16T11:34:20Z"
        },
        {
          "author": "jhoyla",
          "authorAssociation": "CONTRIBUTOR",
          "body": "We also need text on the use of proxies. Something along the lines of:\n> If forwarding a request containing a `Signature` header to a different party, a proxy MUST either use TLS or equivalent protection to talk to both the sender and receiver, or strip the `Signature` header. Parties that receive a `Signature` header over an unsecured channel MUST drop the header without further processing.\n",
          "createdAt": "2025-05-16T11:40:25Z",
          "updatedAt": "2025-05-16T11:40:25Z"
        },
        {
          "author": "jhoyla",
          "authorAssociation": "CONTRIBUTOR",
          "body": "That language doesn't provide total coverage of course, because a proxy that doesn't understand this protocol will still blindly forward it, so a chain of two non-supporting proxies could expose the token if they don't use TLS, but I think it's the best we can do without explicitly binding to the TLS connection.",
          "createdAt": "2025-05-16T11:44:16Z",
          "updatedAt": "2025-05-16T11:44:16Z"
        }
      ]
    }
  ],
  "pulls": [
    {
      "number": 1,
      "id": "PR_kwDOOXJyWM6SQlLt",
      "title": "First pass - mostly motivation adjustments",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/pull/1",
      "state": "CLOSED",
      "author": "smhendrickson",
      "authorAssociation": "NONE",
      "assignees": [],
      "labels": [],
      "body": "",
      "createdAt": "2025-04-11T13:17:32Z",
      "updatedAt": "2025-04-15T15:53:31Z",
      "baseRepository": "thibmeu/http-message-signatures-directory",
      "baseRefName": "main",
      "baseRefOid": "32d3cf4056ff5df2347be885a671c47e8608f300",
      "headRepository": "smhendrickson/http-message-signatures-directory",
      "headRefName": "firstpass",
      "headRefOid": "45f502bf4e3f3f669e718c2a275c84e1f3fbe4f2",
      "closedAt": "2025-04-15T15:53:30Z",
      "mergedAt": null,
      "mergedBy": null,
      "mergeCommit": null,
      "comments": [
        {
          "author": "smhendrickson",
          "authorAssociation": "NONE",
          "body": "Note I renamed this from Automated Agent to agent. I think the `Automation` term blurs intent, and is orthogonal to the purpose of this mechanism.",
          "createdAt": "2025-04-11T13:19:08Z",
          "updatedAt": "2025-04-11T13:19:08Z"
        },
        {
          "author": "smhendrickson",
          "authorAssociation": "NONE",
          "body": "Closing given additions in https://github.com/thibmeu/http-message-signatures-directory/commit/7291dbaa11116b4885574d5c60324d7d7f35278e",
          "createdAt": "2025-04-15T15:53:30Z",
          "updatedAt": "2025-04-15T15:53:30Z"
        }
      ],
      "reviews": []
    },
    {
      "number": 2,
      "id": "PR_kwDOOXJyWM6Sse_X",
      "title": "Add Scott as Author",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/pull/2",
      "state": "CLOSED",
      "author": "smhendrickson",
      "authorAssociation": "NONE",
      "assignees": [],
      "labels": [],
      "body": "Given the changes added in \nhttps://github.com/thibmeu/http-message-signatures-directory/commit/7291dbaa11116b4885574d5c60324d7d7f35278e",
      "createdAt": "2025-04-15T15:56:09Z",
      "updatedAt": "2025-04-15T18:45:18Z",
      "baseRepository": "thibmeu/http-message-signatures-directory",
      "baseRefName": "main",
      "baseRefOid": "d5d43299bd09efa98995bba50f6fccecca19a343",
      "headRepository": "smhendrickson/http-message-signatures-directory",
      "headRefName": "author",
      "headRefOid": "777209bf40a2c79e52c793d321333d33ebb54638",
      "closedAt": "2025-04-15T18:45:17Z",
      "mergedAt": null,
      "mergedBy": null,
      "mergeCommit": null,
      "comments": [
        {
          "author": "smhendrickson",
          "authorAssociation": "NONE",
          "body": "After discussion we are going to use the acknowledgements section until more significant contrib is made. The changes in https://github.com/thibmeu/http-message-signatures-directory/commit/7291dbaa11116b4885574d5c60324d7d7f35278e were mostly editorial, with the exception of Accept-Signatures",
          "createdAt": "2025-04-15T18:45:17Z",
          "updatedAt": "2025-04-15T18:45:17Z"
        }
      ],
      "reviews": []
    },
    {
      "number": 3,
      "id": "PR_kwDOOXJyWM6StJqU",
      "title": "Changes nonce from 32-bit number to string of base64 bytes",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/pull/3",
      "state": "MERGED",
      "author": "EthanHeilman",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "This PR changes the nonce from a 32-bit number to a string containing base64 encoded bytes.\r\n\r\nMy rationale is:\r\n\r\n1. Not fixing the size of the nonce enables signers to avoid nonce collisions by selecting the nonce from a larger space.\r\n2. [RFC 9421 HTTP Message Signatures Section-5.1](https://www.rfc-editor.org/rfc/rfc9421#section-5.1) allows the verifier to specify in the Accept-Signature header the nonce a signer must use in the signature they generate. Existing code may not assume this nonce is limited to 32-bits.\r\n3. RFC 9421 uses strings of base64 encoded bytes in the examples for nonces so this limitation would be unexpected.\r\n4. It allows for the use of signed or otherwise authenticated nonces such as those generated by a random beacon.\r\n\r\nPerhaps we shouldn't limit this to strings of base64 encoded bytes. RFC 9421 defines the nonce as just a string defining it as:\r\n\r\n> nonce:  A random unique value generated for this signature as a String value.\r\n\r\nWhat do you think @thibmeu?\r\n\r\n\r\n",
      "createdAt": "2025-04-15T17:17:15Z",
      "updatedAt": "2025-04-16T12:26:17Z",
      "baseRepository": "thibmeu/http-message-signatures-directory",
      "baseRefName": "main",
      "baseRefOid": "d5d43299bd09efa98995bba50f6fccecca19a343",
      "headRepository": "EthanHeilman/http-message-signatures-directory",
      "headRefName": "patch-1",
      "headRefOid": "fe72a1442f6a23525049f9ea1f71e3ae1555a099",
      "closedAt": "2025-04-16T12:26:16Z",
      "mergedAt": "2025-04-16T12:26:16Z",
      "mergedBy": "thibmeu",
      "mergeCommit": {
        "oid": "9a4c04a35401c2017d1b0bc463029b832f6b1f9d"
      },
      "comments": [],
      "reviews": [
        {
          "id": "PRR_kwDOOXJyWM6lM847",
          "commit": {
            "abbreviatedOid": "4a7c51b"
          },
          "author": "thibmeu",
          "authorAssociation": "OWNER",
          "state": "COMMENTED",
          "body": "This is a good point! uint32 might be restrictive, and is not needed for the security of the protocol.\r\n\r\nAdded a suggestion about using byte-array instead of string, and a specific recommended size",
          "createdAt": "2025-04-16T08:27:17Z",
          "updatedAt": "2025-04-16T08:30:02Z",
          "comments": [
            {
              "originalPosition": 5,
              "body": "```suggestion\r\n: base64url encoded random byte array. It is RECOMMENDED to use a 64-byte array.\r\n```\r\n\r\nI prefer byte array because there is no consideration about the string encoding (ASCII, UTF-8, others). It's likely more generic.\r\n\r\nI think providing a concrete suggestion for the nonce size should help for implementation. `64-byte` sounds good enough, but open for suggestions.",
              "createdAt": "2025-04-16T08:27:18Z",
              "updatedAt": "2025-04-16T08:30:02Z"
            }
          ]
        },
        {
          "id": "PRR_kwDOOXJyWM6lPkAT",
          "commit": {
            "abbreviatedOid": "4a7c51b"
          },
          "author": "EthanHeilman",
          "authorAssociation": "CONTRIBUTOR",
          "state": "COMMENTED",
          "body": "",
          "createdAt": "2025-04-16T12:23:40Z",
          "updatedAt": "2025-04-16T12:23:40Z",
          "comments": [
            {
              "originalPosition": 5,
              "body": "That makes sense to me",
              "createdAt": "2025-04-16T12:23:40Z",
              "updatedAt": "2025-04-16T12:23:41Z"
            }
          ]
        },
        {
          "id": "PRR_kwDOOXJyWM6lPlen",
          "commit": {
            "abbreviatedOid": "fe72a14"
          },
          "author": "thibmeu",
          "authorAssociation": "OWNER",
          "state": "APPROVED",
          "body": "This is much better. Thanks for the prompt and fix!",
          "createdAt": "2025-04-16T12:25:52Z",
          "updatedAt": "2025-04-16T12:25:52Z",
          "comments": []
        }
      ]
    },
    {
      "number": 6,
      "id": "PR_kwDOOXJyWM6S0Oua",
      "title": "Add text on other reasons a server might request a signature.",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/pull/6",
      "state": "MERGED",
      "author": "jhoyla",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "The draft mentions that a server might request a signature if a nonce isn't present in the original request. This adds text mentioning other potential cases that may come up.",
      "createdAt": "2025-04-16T10:24:14Z",
      "updatedAt": "2025-04-16T15:31:24Z",
      "baseRepository": "thibmeu/http-message-signatures-directory",
      "baseRefName": "main",
      "baseRefOid": "9a4c04a35401c2017d1b0bc463029b832f6b1f9d",
      "headRepository": "jhoyla/http-message-signatures-directory",
      "headRefName": "jhoyla/update-sig-acc-reasons",
      "headRefOid": "8aac1314d93cc206a7c69fd9ff6ddd49fb035676",
      "closedAt": "2025-04-16T15:31:24Z",
      "mergedAt": "2025-04-16T15:31:24Z",
      "mergedBy": "thibmeu",
      "mergeCommit": {
        "oid": "5a253b6550023975456e0cd6be41fc7c16d20d0d"
      },
      "comments": [],
      "reviews": [
        {
          "id": "PRR_kwDOOXJyWM6lPou9",
          "commit": {
            "abbreviatedOid": "fd3c3c3"
          },
          "author": "thibmeu",
          "authorAssociation": "OWNER",
          "state": "COMMENTED",
          "body": "",
          "createdAt": "2025-04-16T12:30:07Z",
          "updatedAt": "2025-04-16T12:30:08Z",
          "comments": [
            {
              "originalPosition": 4,
              "body": "```suggestion\r\nOrigin MAY request a new signature with tag \"web-bot-auth\" even if a nonce is provided, for example if it believes the nonce is a replay, or if it doesn't store nonces and thus requests new signatures every time.\r\n```",
              "createdAt": "2025-04-16T12:30:07Z",
              "updatedAt": "2025-04-16T12:30:08Z"
            }
          ]
        }
      ]
    },
    {
      "number": 9,
      "id": "PR_kwDOOXJyWM6TA6B5",
      "title": "Correct reference for @authority",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/pull/9",
      "state": "MERGED",
      "author": "jhoyla",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "Reference points to Section 2.2.1 ([Method](https://www.rfc-editor.org/rfc/rfc9421#section-2.2.1)), but authority is defined in 2.2.3 ([Authority](https://www.rfc-editor.org/rfc/rfc9421#section-2.2.3)).",
      "createdAt": "2025-04-17T16:20:06Z",
      "updatedAt": "2025-04-17T17:44:13Z",
      "baseRepository": "thibmeu/http-message-signatures-directory",
      "baseRefName": "main",
      "baseRefOid": "5a253b6550023975456e0cd6be41fc7c16d20d0d",
      "headRepository": "jhoyla/http-message-signatures-directory",
      "headRefName": "jhoyla/fix-auth-ref",
      "headRefOid": "115eaaf5bdc416f26803e47f53634fceb57bd266",
      "closedAt": "2025-04-17T17:44:13Z",
      "mergedAt": "2025-04-17T17:44:13Z",
      "mergedBy": "thibmeu",
      "mergeCommit": {
        "oid": "3cf7309bb499f26df35e7de1ad2710796cac6df2"
      },
      "comments": [],
      "reviews": [
        {
          "id": "PRR_kwDOOXJyWM6lfk7p",
          "commit": {
            "abbreviatedOid": "115eaaf"
          },
          "author": "thibmeu",
          "authorAssociation": "OWNER",
          "state": "APPROVED",
          "body": "Good catch",
          "createdAt": "2025-04-17T17:44:06Z",
          "updatedAt": "2025-04-17T17:44:06Z",
          "comments": []
        }
      ]
    },
    {
      "number": 15,
      "id": "PR_kwDOOXJyWM6Udviw",
      "title": "Recommend the inclusion of Signature-Agent within Signature-Input",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/pull/15",
      "state": "MERGED",
      "author": "thibmeu",
      "authorAssociation": "OWNER",
      "assignees": [
        "thibmeu"
      ],
      "labels": [
        "enhancement"
      ],
      "body": "Signs Signature-Agent header as part of the request. This is only a recommendation, as some agents may not have a directory exposed via HTTP for instance.\r\n\r\nCloses #12\r\n\r\ncc @punkeel @cramforce",
      "createdAt": "2025-04-30T08:28:48Z",
      "updatedAt": "2025-04-30T15:23:43Z",
      "baseRepository": "thibmeu/http-message-signatures-directory",
      "baseRefName": "main",
      "baseRefOid": "ab0d135fbe8ec694562f4f81540e769fbe003837",
      "headRepository": "thibmeu/http-message-signatures-directory",
      "headRefName": "fix-12",
      "headRefOid": "89512ac393193557a149aa21f3b4c463c946a456",
      "closedAt": "2025-04-30T15:22:22Z",
      "mergedAt": "2025-04-30T15:22:22Z",
      "mergedBy": "thibmeu",
      "mergeCommit": {
        "oid": "e2663b57cf233d3ada5040739957f59dfe30770f"
      },
      "comments": [
        {
          "author": "jhoyla",
          "authorAssociation": "CONTRIBUTOR",
          "body": "I think this is a really good change, it makes it much harder for someone to claim someone else's public key. ",
          "createdAt": "2025-04-30T15:23:42Z",
          "updatedAt": "2025-04-30T15:23:42Z"
        }
      ],
      "reviews": [
        {
          "id": "PRR_kwDOOXJyWM6nVoqW",
          "commit": {
            "abbreviatedOid": "89512ac"
          },
          "author": "punkeel",
          "authorAssociation": "NONE",
          "state": "COMMENTED",
          "body": "",
          "createdAt": "2025-04-30T15:20:41Z",
          "updatedAt": "2025-04-30T15:20:41Z",
          "comments": [
            {
              "originalPosition": 48,
              "body": "(this is also missing `keyid`)",
              "createdAt": "2025-04-30T15:20:41Z",
              "updatedAt": "2025-04-30T15:20:41Z"
            }
          ]
        },
        {
          "id": "PRR_kwDOOXJyWM6nVpA1",
          "commit": {
            "abbreviatedOid": "89512ac"
          },
          "author": "punkeel",
          "authorAssociation": "NONE",
          "state": "APPROVED",
          "body": "",
          "createdAt": "2025-04-30T15:20:59Z",
          "updatedAt": "2025-04-30T15:20:59Z",
          "comments": []
        },
        {
          "id": "PRR_kwDOOXJyWM6nVqX3",
          "commit": {
            "abbreviatedOid": "89512ac"
          },
          "author": "thibmeu",
          "authorAssociation": "OWNER",
          "state": "COMMENTED",
          "body": "",
          "createdAt": "2025-04-30T15:22:16Z",
          "updatedAt": "2025-04-30T15:22:16Z",
          "comments": [
            {
              "originalPosition": 48,
              "body": "and expires, and created. I wanted this to be illustrative, but agree that fixing would be great. doing that in the next commit",
              "createdAt": "2025-04-30T15:22:16Z",
              "updatedAt": "2025-04-30T15:22:17Z"
            }
          ]
        }
      ]
    },
    {
      "number": 16,
      "id": "PR_kwDOOXJyWM6VGrZt",
      "title": "Add test vectors",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/pull/16",
      "state": "MERGED",
      "author": "thibmeu",
      "authorAssociation": "OWNER",
      "assignees": [
        "thibmeu"
      ],
      "labels": [],
      "body": "Two test vectors have been added:\r\n1. ed25519 without Signature-Agent\r\n2. ed25519 with Signature-Agent\r\n\r\nTheir format is similar to RFC 9421.\r\nThey have been generated with the TypeScript implementation https://github.com/cloudflareresearch/web-bot-auth/issues/4",
      "createdAt": "2025-05-06T13:00:34Z",
      "updatedAt": "2025-05-06T15:46:59Z",
      "baseRepository": "thibmeu/http-message-signatures-directory",
      "baseRefName": "main",
      "baseRefOid": "49b518a6ae42c92e97e2bf409c814ac7da0e0931",
      "headRepository": "thibmeu/http-message-signatures-directory",
      "headRefName": "test-vectors",
      "headRefOid": "77fa7242acd98974f23b617623074757243e07b6",
      "closedAt": "2025-05-06T15:46:55Z",
      "mergedAt": "2025-05-06T15:46:55Z",
      "mergedBy": "thibmeu",
      "mergeCommit": {
        "oid": "0d5e567ad961754f0d2e75c4406329064c00161c"
      },
      "comments": [
        {
          "author": "thibmeu",
          "authorAssociation": "OWNER",
          "body": "Relates to #11 ",
          "createdAt": "2025-05-06T15:46:51Z",
          "updatedAt": "2025-05-06T15:46:51Z"
        }
      ],
      "reviews": []
    },
    {
      "number": 17,
      "id": "PR_kwDOOXJyWM6VJRTR",
      "title": "Add considerations about global nonce",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/pull/17",
      "state": "MERGED",
      "author": "thibmeu",
      "authorAssociation": "OWNER",
      "assignees": [
        "thibmeu"
      ],
      "labels": [
        "enhancement"
      ],
      "body": "cc @jhoyla \r\n\r\nClose #7",
      "createdAt": "2025-05-06T17:24:11Z",
      "updatedAt": "2025-05-07T08:33:00Z",
      "baseRepository": "thibmeu/http-message-signatures-directory",
      "baseRefName": "main",
      "baseRefOid": "c4279afa757e29dcb9c71b7d3841833b0a5fe9d0",
      "headRepository": "thibmeu/http-message-signatures-directory",
      "headRefName": "nonce-store",
      "headRefOid": "458c7a26407412bcfecd14d1bf522b1c24b313cb",
      "closedAt": "2025-05-07T08:32:57Z",
      "mergedAt": "2025-05-07T08:32:57Z",
      "mergedBy": "thibmeu",
      "mergeCommit": {
        "oid": "9ca1b81683bc472dd5ef15079be3cf601dae6873"
      },
      "comments": [],
      "reviews": []
    },
    {
      "number": 18,
      "id": "PR_kwDOOXJyWM6VJTii",
      "title": "Multi CDN considerations",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/pull/18",
      "state": "MERGED",
      "author": "thibmeu",
      "authorAssociation": "OWNER",
      "assignees": [
        "thibmeu"
      ],
      "labels": [
        "enhancement"
      ],
      "body": "cc @jhoyla \r\n\r\nCloses #5",
      "createdAt": "2025-05-06T17:28:55Z",
      "updatedAt": "2025-05-07T08:34:54Z",
      "baseRepository": "thibmeu/http-message-signatures-directory",
      "baseRefName": "main",
      "baseRefOid": "9ca1b81683bc472dd5ef15079be3cf601dae6873",
      "headRepository": "thibmeu/http-message-signatures-directory",
      "headRefName": "multi-cdn",
      "headRefOid": "11192919e10fc795f900e9417036bca3992bfda3",
      "closedAt": "2025-05-07T08:34:51Z",
      "mergedAt": "2025-05-07T08:34:50Z",
      "mergedBy": "thibmeu",
      "mergeCommit": {
        "oid": "5d213c19c25ad582349e962d09c53f1d5d69b64b"
      },
      "comments": [],
      "reviews": []
    },
    {
      "number": 21,
      "id": "PR_kwDOOXJyWM6WjQLI",
      "title": "Minor Typo Fixes",
      "url": "https://github.com/thibmeu/http-message-signatures-directory/pull/21",
      "state": "MERGED",
      "author": "hawkinsw",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "",
      "createdAt": "2025-05-17T06:51:54Z",
      "updatedAt": "2025-05-17T18:20:32Z",
      "baseRepository": "thibmeu/http-message-signatures-directory",
      "baseRefName": "main",
      "baseRefOid": "f5ba8c434b869c33215dd5ce161c011e7f0443ec",
      "headRepository": "hawkinsw/http-message-signatures-directory",
      "headRefName": "patch-1",
      "headRefOid": "446d3b41f5d579e867904e1b0c644ae80bf51ff4",
      "closedAt": "2025-05-17T18:20:32Z",
      "mergedAt": "2025-05-17T18:20:32Z",
      "mergedBy": "thibmeu",
      "mergeCommit": {
        "oid": "a8ab1dcf1fa34814cf6656b09ad1207cfcaa9585"
      },
      "comments": [
        {
          "author": "hawkinsw",
          "authorAssociation": "CONTRIBUTOR",
          "body": "I really enjoyed reading the draft and look forward to working with your implementations. I hope that these minor changes are helpful!",
          "createdAt": "2025-05-17T06:52:26Z",
          "updatedAt": "2025-05-17T06:52:26Z"
        }
      ],
      "reviews": [
        {
          "id": "PRR_kwDOOXJyWM6pxpea",
          "commit": {
            "abbreviatedOid": "2a7c4a5"
          },
          "author": "thibmeu",
          "authorAssociation": "OWNER",
          "state": "APPROVED",
          "body": "Looks great. One minor additional correction.\r\n\r\nThank you!",
          "createdAt": "2025-05-17T17:59:47Z",
          "updatedAt": "2025-05-17T18:00:50Z",
          "comments": [
            {
              "originalPosition": 14,
              "body": "correcting another typo here\r\n```suggestion\r\nMentioned in {{signature-agent}}, the Agent MAY send requests with `Signature-Agent` header.\r\n```",
              "createdAt": "2025-05-17T17:59:47Z",
              "updatedAt": "2025-05-17T18:00:50Z"
            }
          ]
        }
      ]
    }
  ]
}